---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# chwork

<!-- badges: start -->
<!-- badges: end -->

The goal of chwork is to provide an analytics library for Community Health Worker related data.

## Installation


You can install lhe development version of chwork from [GitHub](https://github.com/) with:

```{r}
# install.packages("devtools")
devtools::install_github("roboton/chwork")
```

## Example

This is a basic example with simulated data with two worker anomalies (one over and one under).

```{r example}
library(chwork)
set.seed(143)
num_dates <- 90
num_workers <- 30
test_data <- setNames(
  merge(paste0("worker_", 1:num_workers),
        seq(Sys.Date(), Sys.Date() + (num_dates - 1), by = 1),
        colnames = c("worker_id", "date")), c("worker_id", "date"))
start_date <- Sys.Date() + floor(num_dates / 2)
test_data$count <- sapply(1:(num_dates*num_workers),
                          function(x) { rnorm(1, 50, 20) })
test_data[test_data$worker_id == "worker_1" &
            test_data$date > start_date, "count"] <- 99
test_data[test_data$worker_id == "worker_2" &
            test_data$date > start_date, "count"] <- 1
output_dir <- worker_analysis(
  test_data, "test_analysis", start_date = start_date, period = "day",
  sig_p = 0.05 / num_workers) # bonferroni correction
paste("worker analysis output in directory:", output_dir)
```

```{r, results="asis"}
worker_pngs <- list.files("test_analysis/output", pattern = ".png$")

for(png in worker_pngs){
  cat("\n") 
  cat("![", png, "](test_analysis/output/", png, ")", sep = "")
  cat("\n")
}
```
